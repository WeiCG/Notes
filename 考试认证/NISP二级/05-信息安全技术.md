# 密码学基础

## 密码学发展历史

### 古典密码

从古代到19世纪末

古典密码体制的安全性在于保持算法本身的保密性，受到算法限制

- 不适合大规模生产
- 不适合较大的或者人员变动较大的组织
- 用户无法了解算法的安全性

#### 主要分类

- 代替密码（Substitution Cipher)
- 换位密码（Transposition Cipher)
- 代替密码与换位密码的组合

#### 举例

- 象形文字
- 隐写术
- 塞塔式 - 用木棍辅助在纸条下写下内容，抽出木条后就是密文
- 凯撒密码 - 单表系统密码，容易被破解
  - 字母频率分析法
- 多表加密系统 - 通过引入其他的维数（如：字母出现在单词中的位数）来使用不同的密码表

### 近代密码

从20世纪初到1949年 - 两次世界大战的推动

主要标志是**机械密码/机电密码**，用机工代替手工，出现了轮转机，其中最著名的便是二战中德军使用的ENIGMA

与古典密码没有什么本质进步，只是用机械代替了手工使得计算能力大幅度提高

#### 一次一密

理论上不可攻破的密码

- 不重复使用乱码本，所以密码表只使用一次
- 使用不可预知的随机数（一般来自物理源，如放射线衰减）

但有个问题，如何传递密码本？

### 现代密码

从C.E.Shannon(香农)于1949年发表的划时代论文“The Communication Theory of Secret Systems”开始

密码学开始进化，出现了新特点：**数据的安全基于密钥而不是算法的保密**

### 公钥密码

从1976年W.Diffie和M.Hellman创造性地发表了论文“New Directions in Cryptography”开始

公钥密码使得发送端和接收端无密钥传输的保密通信成为可能

## 密码学基本概念

密码学是研究信息系统安全保密的科学。由两个相互独立、相互争斗，而又相辅相成、相互促进的分支科学所组成，分为密码编码学和密码分析学。

### 密码相关术语

- 加密 - 将明文变换为密文的过程，把人类可懂的语言变换为人类不可懂的语言
- 解密 - 加密的逆过程，即由密文恢复成原明文的过程，把人类不可懂的语言变换为人类可懂的语言
- 密钥 - 加密和解密通常是在一组密钥的控制下进行的，分别称为加密密钥和解密密钥
- 密钥空间 - 用于加密的密钥的比特序列长度
  - 密钥是由密钥空间的随机值构成，密钥空间越大，密钥被攻破的难度就越大
- 密钥管理 - 处理密钥自产生到最终销毁的整个过程中的相关问题，包括系统的初始化、密钥的产生、存储、备份/恢复、装入、分配、保护、更新、泄露、撤销和销毁等
- 扩散 - 将每一位明文数字的影响尽可能地散步到多个输出密文数字中去，以更隐蔽明文数字的统计特性
- 混乱 - 使得密文的统计特性与明文、密钥之间的关系尽量复杂化

### 密码分析方式

- 唯密文攻击 - 攻击者知道一些消息的密文，并试图恢复出其所对应的的明文，并进一步试图推算出加密消息的密钥
- 已知明文攻击 - 攻击者不仅知道一些消息的密文，也知道这些密文对应的明文，并试图推导出加密密钥或算法
- 选择明文攻击 - 在已知明文攻击的基础上，攻击者还可以自己选择被加密的明文，并试图推导出加密密钥或算法
- 选择密文攻击 - 攻击者能够选择不同的密文并能得到对应的明文，并试图推导出加密密钥或算法
- 旁路攻击 - 通过搜集“外面”的信息来破解密码，而不是直接处理“里面”的东西
- 重放攻击 - 攻击者捕获了一些类型的数据并重新提交它，寄希望于欺骗接受设备误以为这些是合法信息
- 统计式攻击 - 利用明文的已知统计规律进行破译的方法。攻击者对截获的密文进行统计分析，总结出其统计规律，并与明文的统计规律进行对照比较，从中提取出明文和密文直接的对应或变换信息

### 密码体制分类

- 受限制的算法 VS 基于密钥的算法
  - 前者是算法的保密性基于保持算法的秘密
  - 后者是算法的保密性基于对密钥的保密
- 对称密码 VS 非对称密码
  - 前者的加密密钥和解密密钥相同，或实质上等同（从一个易于推出另一个）
  - 后者的加密密钥和解密密钥不同，从一个很难推出另一个
- 分组密码 VS 流密码（序列密码）
  - 前者将明文分成固定长度的组，用同一个密钥和算法对每一块加密，输出也是固定长度的密文
  - 后者每次加密一位或一字节的明文
- 代替密码 VS 置换密码
  - 前者就是将明文中的每一个字符被替换为密文中的另一个字符。接收者对密文做反向替换就可以恢复出明文
  - 后者则是明文中的字母保持相同，但顺序被打乱了

### 密钥管理

在一种安全策略指导下，密钥的产生、存储、分配、删除、归档及应用

所有的密码技术都依赖于密钥，这是一个很复杂的课题而且是保证安全性的关键点

- 密钥的生存周期
  - 所有密钥都有生存周期，包括：产生、分配、使用、更新/替换、撤销、销毁
  - 拥有大量的密文有助于密码分析，而一个密钥使用得太多会给攻击者增大搜集密文的机会
- 密钥的产生
- 密钥的分配
  - 无中心的密钥分配模式
  - 中心化密钥分配模式
  - 公钥密钥体制的密钥分配 - 最常用
- 密钥管理的其他阶段
  - 密钥使用
  - 密钥存储 - 现更多的存储在USB Key中
  - 密钥更新 - 最容易的解决方法是从旧密钥中产生新密钥；公私钥对重新生成
  - 密钥备份 - 可信第三方托管或使用主密钥或公钥加密保存，主要针对加密密钥
  - 密钥销毁 - 物理上彻底粉碎

## 对称密码算法

## 公钥密码算法

## 散列函数和消息鉴别